package api

import (
	"testing"

	"github.com/stretchr/testify/assert"
	"k8s.io/client-go/kubernetes"
)

const dmzClusterConfig = `apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJDZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1USXlPVEF6TWpFeU1Gb1hEVE14TVRJeU56QXpNakV5TUZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBT1BMCkV1ckQxWFM3RnRtTGpKRGsvTlJVbFVZMk92bUJCVndydHBVek9yckpIWXhnUEVwSzNTKzlxelJqTEsybTJyZFYKZmZaR1d4emYxT3BKc0VmVWl5eUl0dEUvRTFXZVRSOWpiVXBkbFhxcnl4SVEvUW93Q2s3QmZvVE1wTUxaNktNWQpaa1RPN1g3V2RDb2FWV05WNngvV3FVYkFQTzM3N1hFSzZRZEh2aGJ0SmhEbHc2OVEzQ0o3U1NEalY1NnF5dTl0CnJYT3ZKNDROeEFzQ2E1NDFmcG5ZM3BDM1hDNm90MHkvWTlZbEplWFRObnlvd1BZWVFzLzZlcmVpYmFJY21lNkwKNDVaZUlZcnlsdEl6cjV5VXdoR0Rvd2hoK3FlTi9NZUtrMDhpb3JFZ3VDb0QzcFJCdkxkd2dhSFJvU2UzRlJDbApxU2lCODU0ZXVOc2JpR25ieUhVQ0F3RUFBYU1qTUNFd0RnWURWUjBQQVFIL0JBUURBZ0tVTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFOMFhDZVdnb0UwNy94TDh5Y3pZUEhlVUU3d1kKZE5hSlZzNkRVQS9kcno3K05HVm1QeWFzbFdOUzhSRDVVOVlXQnZ6ZDdlNVNTVktleThOK2N2b25pMlU1TXIzWQpNWHZFZDFUN1NKZ1dWN25va1hWdTRjQm5hUVR5TlBrU2NyOXVlNWIrbDd6Wmo5MEJub2ZhVkFMeTlNVmhEaCtMCkE2WXhMeWVFZG1ZQVdFMTA5RWE4RGVzUTMxK1ZJU1lkMHlQYzJlYXA1YWt5bEdmTk5LbHlQNTVGSGpBVDFjeDkKWThyQ0dQUDNjUTZtQ1d0bUVPOTVVTlZscWR3dEh3a2ExeDVleXFLYUxRWkZIOHRVMEpuVU1nNFR2ME1OWmJrdQpPZUJzTU1DbVZhUlZZWkZUZSs5eTFsM29vNEpUdzFGN0dEb1A3QksrYmQ2cVRIRXVVQUJEQnd0cVducz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
    server: https://cls-b7c1jlj3.ccs.tencent-cloud.com
  name: cls-b7c1jlj3
contexts:
- context:
    cluster: cls-b7c1jlj3
    user: "100021043606"
  name: cls-b7c1jlj3-100021043606-context-default
current-context: cls-b7c1jlj3-100021043606-context-default
kind: Config
preferences: {}
users:
- name: "100021043606"
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURERENDQWZTZ0F3SUJBZ0lJWmVzL1FFbXdSVW93RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TVRFeU16QXhNekF4TVRGYUZ3MDBNVEV5TXpBeE16QXhNVEZhTURZeApFakFRQmdOVkJBb1RDWFJyWlRwMWMyVnljekVnTUI0R0ExVUVBeE1YTVRBd01ESXhNRFF6TmpBMkxURTJOREE0Ck5qa3lOekV3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQ2tBUzBQSlU1Zi9Cd2kKZ1BBZ3lhY1pIZEhrMlY5TzhoYVJabjRIOHdQNk12ek1DMzJPa2NQQ3E0enVxcnBVYVBULzlYSVVuT1UyUjJ0ZwpJK3RhSk1xdUluUkZCQ0Zac0hGNTFUeWJidmFPNHVaQTJvMUVxN3dPZ3dnSmFqM2tvUHRVcGorQzR2dGxQNHR0ClM1NEtZc2VteWZPTFlHYXlWNEFEQ0JJSEdFMWZrenhUVTlGRDFUZ2F2S1JzRS9yQW9IYzJuWWI1VEk0dkNtam0KN3Ixc0x2MmxBQlBwK1prQlFUbUprZUVjNEZnSVdYSGlETlZnTXNFOE1rSFVtbExtQm8yeHNyRXo0dVRReENONQpMakdDMGZvNGJ3MlRCUHFxQnh3ZFlKWUpZZTJYQTE2WkF1eERIKzU3RGtSeEJGT3Y4aWVCU0svckRVVWx3T0Z2CktiTGVPcnFaQWdNQkFBR2pQekE5TUE0R0ExVWREd0VCL3dRRUF3SUNoREFkQmdOVkhTVUVGakFVQmdnckJnRUYKQlFjREFnWUlLd1lCQlFVSEF3RXdEQVlEVlIwVEFRSC9CQUl3QURBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQQoxZ3JYT2Z6blFUZyt4Wm9sb2FvTXBIZzM4R0V1Y2dkN3E1NTgySEo1K2oxMWIxV1U4WTR0NDArelNxTjU2R2hNClo5WWdaVm00VVM1ZG5QR2o2V1ltWVRxNFBpTkx3WkRoeWMwVGRmcjNlQ0xTMGVXY2FUaDNmeDVBVkY5RUtaR1gKSUQ4ZUNQd3Q3VVJJUFNvbVBUazNtb1BHdWN1eVBwU28vS2tLV0pxS1M1cVIwaFlLbHFRcXV6bUZDeFB4TzRmUgpFdk0zekRyY2tWSnd1NzBYWkJtYmVKMHZiWUxUYm9RUEMrTk9LVWpjWHNIaVJtdHlLdFZSbk84WFRBcVc0NWViCm13cFlYRUlJTHpFd0l1eVFCWENTY093bmRCbVQrWDlWZEQ4T0pTYnRtQzNUdEc2bEczUmh6TnljTElXZ0FtejMKSVpRZC9lYzV0ZTBWQk5LR1hVdU1FQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBcEFFdER5Vk9YL3djSW9Ed0lNbW5HUjNSNU5sZlR2SVdrV1orQi9NRCtqTDh6QXQ5CmpwSER3cXVNN3FxNlZHajAvL1Z5Rkp6bE5rZHJZQ1ByV2lUS3JpSjBSUVFoV2JCeGVkVThtMjcyanVMbVFOcU4KUkt1OERvTUlDV285NUtEN1ZLWS9ndUw3WlQrTGJVdWVDbUxIcHNuemkyQm1zbGVBQXdnU0J4aE5YNU04VTFQUgpROVU0R3J5a2JCUDZ3S0IzTnAyRytVeU9Md3BvNXU2OWJDNzlwUUFUNmZtWkFVRTVpWkhoSE9CWUNGbHg0Z3pWCllETEJQREpCMUpwUzVnYU5zYkt4TStMazBNUWplUzR4Z3RINk9HOE5rd1Q2cWdjY0hXQ1dDV0h0bHdOZW1RTHMKUXgvdWV3NUVjUVJUci9JbmdVaXY2dzFGSmNEaGJ5bXkzanE2bVFJREFRQUJBb0lCQUgzSGdSMDZpVTlIOVBQcApXMEJxSjBNMkFZRzN6RWFwbC9GUFg1ME5IYUhIZE9Xd2NrempNZldjeCt0SytMZy8vcFpIVVlUSmgya0hnU3dzCm9CVjBYaFVLeTQwYXk5RVRaeFAvSEFwQkljc1g3V3NUc29CV0RWWTcyL0FNa1FkRkJ6dzJmRU1QZmFwNi81MkUKL3VJTU8vNklwOFhlMnlRdnd6ZVArdk9DQ2VVZnRpVXpWUWpCNGVXVlBYNWFhaktVYkx6K2tnMWpFMldNbXhlUQpBSitXM0l3Z3ZNdUlHV2wyaFBEZjlDdHR5STI1UVM1YlE1ckROWWVHOGVYRVNmU1JFNDZpMG4wdCtvV1d6VVB0CjVqd25XWHYvaFVZMDIzdVdHa2hJbzlHWm0yaGs4elRIMzNjTkZQcFU5UVF4VGVlUzJWUDJLUENRSzVjL3pYc3QKYTZuL2MyRUNnWUVBeURhVnIxOFU3VjhEMEJ2a2tKbGNBc3Byc3dnYkpiWXpkdE0xVzNaNEpncThMbjVDd25USwpaclZKRmR3cFphajE1UHNCVGRiSTI1WkVLS2trWTNENDdralhlM1NEMmdESm1lWG9SYlN4ZjRtQ3dOK29SSjlMCnN0c1d0eUVnMC9zbk01dUdNOC9oYkJMQmR5cWRISkNYT3hGVmNGbFJKczFvdGxVRWdLYkh0YlVDZ1lFQTBiUEsKNTd6WWNPcGNXWWFYcVdoQlA5elU1bk9UZGVVU2pmRVM2WFJENStWcVl3QUVSYUEzWTYramRiTFFzdG54OGRBcwpmbGtxYVp5eTFlSXRXMnUvWU8walNPWDhnakVQaEhwdXBYbjZNSWNyY3orS0lvUmFMamNlaStmSjVCdlNrdnlkCnB4RXN2bWpjVUhaeEVMYmwwRWNBcU5XS29aSjJVU29mbnFxVlA5VUNnWUVBaUY0VmFoT2JEMnF1RUN0UGJPWG4KODhhbndKTisyaHJWeHROby9sa2MwTnh5L0QvbmZNZExyTlZCYUhCQ2lnbWhJa3VNd2RYUGpURTJUM09WWTEzcApUM094d1ZiRkQ5R0ZmeHRITDJNNW1xS3d1bW9jRkZGam4vajE2ZG5Zb0VucWs0NFV4R21OSXExTHRMMERzaGNSCnlwdXQxQTRoNWduMmptb3QzT3E4RUJrQ2dZRUF4QmdBa1p0Q09yU3REdnFSTDlWUnpzcE9QQUd2enZzYTBxaXcKS3FhU0tYT2FmR0V6blhnbzA0c1dxNlUvQzBCS3d2a0w0a3EzSW5OcHVCLzhraFM3cllPVEQwUWhVQTFZbVdWegp1a0hKOXo4dkhtSTRaZmFsN2JtVlV2YTVFQm9FVzNibVphZmwwMWh6VExxMUdCQXY3d2UyVWlyOXJBRXRxdEJkCktSNFMydEVDZ1lBMUoxRHpOR1JtaVJYTXpLcjFkbjlja1QzdVp4akRkVXBMWDNnTUp0SURiamJuTGFPTHFzVU8KeWJYS3dZN0NKZW5oNGJrM0xhaldFS0xTSVJQTmt5UG9PVE5qKy84amVoaHpxMFRMcWVMK1kwSEtaaW9pRjFMTgpkUG50cVFSTnBheldCVXU3TkxNd0swdW81RjBFUEgyWkNvUjkwQmthd25ZcWNjbXI4b0h0aGc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=`

func TestGetK8sClient(t *testing.T) {
	var c = kubernetes.Clientset{}
	tests := []struct {
		name   string
		input  string
		fields []string
		expect *kubernetes.Clientset
	}{
		{
			name:   "connect k8s cluster",
			input:  dmzClusterConfig,
			expect: &c,
		},
	}

	for _, test := range tests {
		t.Run(test.name, func(t *testing.T) {
			actual, err := GetK8sClient(test.input)
			if err != nil {
				t.Fatal(err)
			}
			assert.EqualValues(t, test.expect, actual)
		})
	}

}
